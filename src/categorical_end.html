<html>

<head>
    <title>Categorical Variables and Summary</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Keep these in head -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/python/python.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.css" />
    <link rel="stylesheet" href="https://codemirror.net/theme/night.css">
    <script src="https://cdn.jsdelivr.net/npm/vue-codemirror@4.0.6/dist/vue-codemirror.min.js"></script>

    <link rel="stylesheet" href="page_template/w3.css">
    <link rel="stylesheet" href="page_template/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-147552064-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-147552064-1');
</script>

<style>
    body,
    h1 {
        font-family: "Raleway", Arial, sans-serif
    }
    
    h1 {
        letter-spacing: 6px
    }
    
    .w3-row-padding img {
        margin-bottom: 12px
    }
</style>

<body>

    <div id="nologin" style="display:none">
        <h1 class="w3-content w3-center">
            You have not logged in to our page. Please click
            <a href="index.html"> here</a> to return.
        </h1>
    </div>

    <!-- !PAGE CONTENT! -->
    <div class="w3-content" id="app" style="max-width:1500px">

        <!-- Header -->
        <header class="w3-panel w3-center w3-opacity">
            <h1 class="w3-xlarge">Regression Analysis</h1>
            <h1>Categorical Variables and Overall Summary</h1>

            <div class="w3-padding-16">
                <div class="w3-bar w3-border">
                    <a href="#intro" class="w3-bar-item w3-button">Intro</a>
                    <a href="#cat" class="w3-bar-item w3-button">Categorical Variables</a>
                    <a href="#summary" class="w3-bar-item w3-button">Using your models</a>
                    <a href="#exercise1" class="w3-bar-item w3-light-grey">Exercise 1</a>
                    <a href="#exercise2" class="w3-bar-item w3-light-grey">Exercise 2</a>
                </div>
            </div>
            <div>
                Your save code is {{sessionStorage.getItem("userID")}}
            </div>
        </header>

        <!-- Intro Container -->
        <div class="w3-container" id="intro" style="padding:64px 16px">
            <div class="w3-content" style="max-width:800px">
                <div class="w3-opacity">
                    <h1 class="w3-center w3-padding-large"><span class="w3-header" style="font-size:36px">Introduction</span></h5>
                        <p>Remember the titanic data set from the previous section? Let's take a quick peek at it again.</p>
                </div>
                <img src="https://raw.githubusercontent.com/danielnyan/bt3103-1d4-statistical-learning/master/img/titanic_head.png" class="w3-image">
                <div class="w3-opacity">
                    <p>If we also want to use columns like 'Name', 'Sex', 'Ticket', 'Cabin', and 'Embarked' in our predictive model, can we just put them in our model? No we can't! If we want to use them, we first have to convert them into numbers that we
                        can put into a mathematical equation! But before that, we should first take a look at the number of unique categories each variable has.</p>
                    <pre class="w3-border">
          <code>
    print(df.shape)
    print("Unique names:" , len(df["Name"].unique()))
    print("Unique genders:" , len(df["Sex"].unique()))
    print("Unique ticket numbers:" , len(df["Ticket"].unique()))
    print("Unique cabins:" , len(df["Cabin"].unique()))
    print("Unique embarkment location:" , len(df["Embarked"].unique()))
          </code>
        </pre>
                    <p>We will get the following output.</p>
                    <p>(891, 12)</br>
                        Unique names: 891</br>
                        Unique genders: 2</br>
                        Unique ticket numbers: 681</br>
                        Unique cabins: 148</br>
                        Unique embarkment location: 4</p>
                    <p>Let's start simple and take a look at the 'Sex' column. There are two categories, male and female. There is a very convenient code in pandas that converts categorical variables into dummy numerical. Let's dive right into it, shall
                        we?
                    </p>
                    <pre class="w3-border">
                        <code>
    df_sex = pd.get_dummies(df["Sex"])
    df_sex.head(5) # Peek at the top 5 rows
                        </code>
                    </pre>
                </div>
                <img src="https://raw.githubusercontent.com/danielnyan/bt3103-1d4-statistical-learning/master/img/cate_var_preview.png" class="w3-image">
                <div class="w3-opacity">
                    <p>Since passengers can only either be male or female, we actually only need one of the columns, since if female = 0, it must mean male = 1. We can replace the 'Sex' column with our new column.</p>
                    <pre class="w3-border">
                        <code>
    df["Sex"] = df_sex["female"]
    df.head(5) # Peek at the top 5 rows
                        </code>
                    </pre>
                </div>
                <img src="https://raw.githubusercontent.com/danielnyan/bt3103-1d4-statistical-learning/master/img/cate_var_preview2.png" class="w3-image">
                <div class="w3-opacity">
                    <p>If the passenger's sex is male, they are now assigned a value of 0. If the passenger is female, they are assigned a value of 1.</p>
                    <p>That was rather simple, wasn't it? But as the number of unique categories get larger, things start to get slighly messier.</p>
                </div>
            </div>

            <!-- Cat Container -->
            <div class="w3-container" id="cat" style="padding:64px 16px">
                <div class="w3-content" style="max-width:800px">
                    <div class="w3-opacity">
                        <h1 class="w3-center w3-padding-large"><span class="w3-header" style="font-size:36px">Non-binary categorical values</span></h5>
                            <p>Let's take a look at 'Embarked'. </p>
                            <pre class="w3-border">
                            <code>
    print(df["Embarked"].unique())
                            </code>
                        </pre>
                            <p>The output we get is: </p>
                            <h5 style="text-align:center;">['S' 'C' 'Q' nan]</h5>
                            <p>Can we simply replace each location with a different number from 1 to 4? S = 1, C = 2, Q = 3, nan = 4. Is this okay? No, it is not. </br>
                                ...</br>
                                What is to say that each embarkment location has the same constant effect on survivorship? Using an example, assume \({survivorship = coef*embarkment}}\). Can we really say changing from location S to location C increases survivorship by the same coefficient,
                                as changing from C to Q?
                            </p>
                            <p>We cannot.</p>
                            <p>The proper method of modelling such categorical data is to model each category as a boolean variable. In fact, we have already done this in our 'Sex' example in the intro.</p>
                            <pre class="w3-border">
                                    <code>
    df_embarked = pd.get_dummies(data = df["Embarked"], dummy_na = True)
    df_embarked.head(5) # Peek at the top 5 rows
                                    </code>
                                </pre>
                    </div>
                    <img src="https://raw.githubusercontent.com/danielnyan/bt3103-1d4-statistical-learning/master/img/cate_var_preview3.png" class="w3-image">
                    <div class="w3-opacity">
                        <p>The get_dummies() function does not consider nan values by default. If you want to include nan values in the table, you have to add in the argument dummy_na=True when calling the function.
                        </p>
                        <p>We can't simply replace the Embarked column any more, like we did with Sex. In this case, we can append this new df_embarked table to the original table!</p>
                        <pre class="w3-border">
                                <code>
    df_embarked = df_embarked.drop(np.nan,axis = 1)
    df = pd.concat([df,df_embarked], axis = 1)
    df.head(5)
                                </code>
                            </pre>
                    </div>
                    <img src="https://raw.githubusercontent.com/danielnyan/bt3103-1d4-statistical-learning/master/img/cate_var_preview4.png" class="w3-image">
                    <div class="w3-opacity">
                        <p>Wait, why did we drop one of the columns?</p>
                        <p>In this case, Embarked can either be C, Q, S, or nan. What happens when C, Q, S = 0? That's right, it's implied that nan = 1 in that case. Including the nan column is redundant here. In fact, this is the same case for all categorical
                            values. You do not need to include the last column, as the last category is implied if all the other categories have the value of 0.
                        </p>
                    </div>
                </div>
            </div>

            <!-- End Page Content -->
        </div>

        <!-- Footer -->
        <footer class="w3-container w3-padding-64 w3-light-grey w3-center w3-large">
            <p>Tutorial created by Team 1d4 (Brandon, Daniel, Meng Yuan, Nelson) for our BT3103 Module Project</p>
            <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank" class="w3-hover-text-green">w3.css</a></p>
        </footer>

</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="./scripts/utils.js"></script>
<script src="./scripts/probit_logit.js"></script>

</html>